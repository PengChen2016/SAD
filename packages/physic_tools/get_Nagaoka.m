function [ k ] = get_Nagaoka( a)
% 对无限长螺线管电感公式做几何修正，以计算有限长螺线管的电感
% a：螺线管线圈2R/l 直径/长度，0<a<10
% k：长冈系数

%% 导入数据
% 长冈系数的求解：见https://ja.wikipedia.org/wiki/長岡係数
% 长冈系数的数据：见1909Nagaoka - The inductance coefficients of solenoids
Nagaoka_data=textread('Nagaoka.txt');
% Nagaoka_data=get_Nagaoka_data();

if ~isnan(a)
    %% 插值
    k = interp1(Nagaoka_data(:,1),Nagaoka_data(:,2),a,'linear',0);
    idx=find(a<Nagaoka_data(1,1) | a>Nagaoka_data(end,1));
    if ~isempty(idx)
        warning('[WARN] a of the following idx are out of the range of the built-in Nagaoka_data, approxiamated as k=0. ')
        disp(idx')
    end
else
    %% 显示
    k=figure;
    plot(Nagaoka_data(:,1),Nagaoka_data(:,2))
    ylabel('k');
    xlabel('a=2R/l')
    title('Nagaoka coefficient');
    grid on%显示网格
end
end

% function Nagaoka_data=get_Nagaoka_data()
% Nagaoka_data=[...
%     0   1;...
%     0.01    0.996;...
%     0.02    0.992;...
%     0.03    0.987;...
%     0.04    0.983;...
%     0.05    0.979;...
%     0.06    0.975;...
%     0.07    0.971;...
%     0.08    0.967;...
%     0.09    0.963;...
%     0.1 0.959;...
%     0.11    0.955;...
%     0.12    0.951;...
%     0.13    0.947;...
%     0.14    0.943;...
%     0.15    0.939;...
%     0.16    0.935;...
%     0.17    0.931;...
%     0.18    0.928;...
%     0.19    0.924;...
%     0.2 0.92;...
%     0.21    0.913;...
%     0.23    0.909;...
%     0.24    0.905;...
%     0.25    0.902;...
%     0.26    0.898;...
%     0.27    0.894;...
%     0.28    0.891;...
%     0.29    0.887;...
%     0.3 0.884;...
%     0.31    0.88;...
%     0.32    0.877;...
%     0.33    0.873;...
%     0.34    0.87;...
%     0.35    0.867;...
%     0.36    0.863;...
%     0.37    0.86;...
%     0.38    0.856;...
%     0.39    0.853;...
%     0.4 0.85;...
%     0.41    0.847;...
%     0.42    0.843;...
%     0.43    0.84;...
%     0.44    0.837;...
%     0.45    0.834;...
%     0.46    0.831;...
%     0.47    0.827;...
%     0.48    0.824;...
%     0.49    0.821;...
%     0.5 0.818;...
%     0.51    0.815;...
%     0.52    0.812;...
%     0.53    0.809;...
%     0.54    0.806;...
%     0.55    0.803;...
%     0.57    0.797;...
%     0.58    0.794;...
%     0.59    0.791;...
%     0.6 0.789;...
%     0.61    0.786;...
%     0.62    0.783;...
%     0.63    0.78;...
%     0.64    0.777;...
%     0.65    0.774;...
%     0.66    0.772;...
%     0.67    0.769;...
%     0.68    0.766;...
%     0.69    0.764;...
%     0.7 0.761;...
%     0.71    0.758;...
%     0.72    0.756;...
%     0.73    0.753;...
%     0.74    0.75;...
%     0.75    0.748;...
%     0.76    0.745;...
%     0.77    0.743;...
%     0.78    0.74;...
%     0.79    0.738;...
%     0.8 0.735;...
%     0.81    0.733;...
%     0.82    0.73;...
%     0.83    0.728;...
%     0.84    0.725;...
%     0.85    0.723;...
%     0.86    0.72;...
%     0.87    0.718;...
%     0.88    0.716;...
%     0.89    0.713;...
%     0.9 0.711;...
%     0.91    0.709;...
%     0.92    0.706;...
%     0.93    0.704;...
%     0.94    0.702;...
%     0.95    0.7;...
%     0.96    0.697;...
%     0.97    0.695;...
%     0.98    0.693;...
%     0.99    0.691;...
%     1   0.688;...
%     1.05    0.678;...
%     1.1 0.667;...
%     1.15    0.657;...
%     1.2 0.648;...
%     1.25    0.638;...
%     1.3 0.629;...
%     1.35    0.62;...
%     1.4 0.611;...
%     1.45    0.603;...
%     1.5 0.595;...
%     1.55    0.587;...
%     1.6 0.58;...
%     1.65    0.572;...
%     1.7 0.565;...
%     1.75    0.558;...
%     1.8 0.551;...
%     1.85    0.544;...
%     1.9 0.538;...
%     1.95    0.532;...
%     2   0.526;...
%     2.1 0.514;...
%     2.2 0.502;...
%     2.3 0.492;...
%     2.4 0.482;...
%     2.5 0.472;...
%     2.6 0.463;...
%     2.7 0.454;...
%     2.8 0.445;...
%     2.9 0.437;...
%     3   0.429;...
%     3.1 0.422;...
%     3.2 0.414;...
%     3.3 0.408;...
%     3.4 0.401;...
%     3.5 0.394;...
%     3.6 0.388;...
%     3.7 0.382;...
%     3.8 0.376;...
%     3.9 0.371;...
%     4   0.365;...
%     4.1 0.36;...
%     4.2 0.355;...
%     4.3 0.35;...
%     4.4 0.346;...
%     4.5 0.341;...
%     4.6 0.336;...
%     4.7 0.332;...
%     4.8 0.328;...
%     4.9 0.324;...
%     5   0.32;...
%     5.5 0.302;...
%     6   0.285;...
%     6.5 0.271;...
%     7   0.258;...
%     7.5 0.247;...
%     8   0.237;...
%     8.5 0.227;...
%     9   0.219;...
%     9.5 0.211;...
%     10  0.203;...
%     ];
% end